﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿1.单步脱壳的基本原则就是单步跟踪，只能往前，不能往后，遇见Call函数在其下一步F4，遇见向下的JMP也在其下一步F4。  2.脱壳的一般流程是：查壳->寻找OEP->Dump->修复。找OEP的一般思路如下： 先看壳是加密壳还是压缩壳，压缩壳相对来说容易些，一般是没有异常，找到对应的popad后就能到入口，跳到入口的方式一般为：jmp OEP、push OEP ret、call OEP。  3.手工脱壳一般情况是分三步：一是查找程序的真正入口点（OEP）；二是抓取内存映像文件；三是输入表重建。  4.ESP定律：脱壳时看到ESP变红，右键ESP下硬件断点，然后F9，F8调试到执行一个大的跳转就进入了OEP。对于输入字符，按Enter后就无法再进行调试，直接失败Try again。所以要在进入之后查找中文ASCII码（OD的插件，比查找参考文本字符串更好用）。可以用ddXXXX和hrXXXX（XXXX指的是ESP的值）来在数据窗口跟踪。  5.二次内存镜像法。打开内存后，在.rsrc处下断，再在UPX0处下断，即可进入OEP。 选择菜单的选项->调试选项->异常。  勾选所有的忽略异常。  按下ALT+M, 打开内存镜像, 找到程序的第一个.rsrc, 按 F2 下断点, 然后按SHIFT+F9运行到断点。  再按ALT+M, 打开内存镜像, 找到程序的第一个.rsrc上面的.text, 按 F2 下断点. 然后按SHIFT+F9（或者是在没异常情况下按 F9）。  6.一步直达法。直接Ctrl+F搜索popad，适用于大部分的UPX和ASPACK壳。  7.脱下来的三种方法：OD的两种插件（右键，用OllyDump调试脱壳进程），以及LordPE。首先修正镜像大小，再完整转存。之后再用ImportPE输入重建表，将其OEP改为实际的OEP，再转存到exe文件中。   8.DUMP 及 IAT 重建。在找到程序 OEP 后, 我们需要将程序 dump 出来, 并重建IAT. IAT全名是Import Address Table, 表项指向函数实际地址.我们找到了 OEP, 到达了程序的真正入口点. 我们这时就需要将程序 dump 出来. 我们右键, 选择"用OllyDump脱壳调试进程"(不过你也可以使用LoadPE来 dump 出来):弹出一个窗口, 看一下地址是否正确, 主要就是看看入口点地址有没有选对. 然后取消勾选重建输入表.  对于一些简单的壳, 你 dump 出来发现无法正常运行, 如果你确实找到了正确的 OEP 并用IDA反编译查看结果良好, 那么你的第一想法就应该是程序的IAT出现了问题. 你就需要重建IAT.打开ImportREC, 选择一个正在运行的进程原版.exe(原版.exe是我在 OD 中正在调试的进程, OD 中的EIP正处在OEP位置, 在用Ollydump之后不要关闭这个进程.). ImportREC修复输入表入口点需要知道OEP, 也就是要在窗口右侧中间的OEP输入框中进行输入。  9.注意在Dump前记住OEP的值。10.at GetVersion，适用于NSpack北斗3.0以前的壳。